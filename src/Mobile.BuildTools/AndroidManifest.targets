<?xml version="1.0" encoding="utf-8" ?>
<Project>

  <UsingTask TaskName="Mobile.BuildTools.Tasks.TemplateManifestTask"
             AssemblyFile="$(_MobileBuildToolsParentBuildTasksDll)"/>

  <Target Name="_GatherManifests"
          Condition="$(BuildToolsEnableTemplateManifests)">
    <PropertyGroup>
      <TemlateAppManifest>$(IntermediateOutputPath)android\AndroidManifest.xml</TemlateAppManifest>
    </PropertyGroup>
  </Target>

  <Target Name="HandleAndroidManifest"
          AfterTargets="_GenerateJavaStubs"
          DependsOnTargets="_SetLatestTargetFrameworkVersion;MobileBuildToolsInit"
          Condition="$(BuildToolsEnableTemplateManifests)">
    <TemplateManifestTask ConfigurationPath="$(BuildToolsConfigFilePath)"
                          ProjectDirectory="$(MSBuildProjectDirectory)"
                          SolutionDirectory="$(SolutionDir)"
                          IntermediateOutputPath="$(IntermediateOutputPath)"
                          SdkShortFrameworkIdentifier="$(_SdkShortFrameworkIdentifier)"
                          ReferenceAssemblyPaths="$(_XATargetFrameworkDirectories)" />
  </Target>

  <Target Name="AutomaticBuildVersioning"
          AfterTargets="HandleAndroidManifest;HandleTokenizedInfoPlist"
          Condition="$(BuildToolsEnableAutomaticVersioning)">

    <AutomaticBuildVersioningTask ConfigurationPath="$(BuildToolsConfigFilePath)"
                                  ProjectDirectory="$(MSBuildProjectDirectory)"
                                  SolutionDirectory="$(SolutionDir)"
                                  IntermediateOutputPath="$(IntermediateOutputPath)"
                                  SdkShortFrameworkIdentifier="$(_SdkShortFrameworkIdentifier)"
                                  ReferenceAssemblyPaths="$(_XATargetFrameworkDirectories)" />
  </Target>

</Project>